<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lucide-static@latest/font/Lucide.css">
    <style>
        /* Use Inter font */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for slider thumb */
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #dc2626; /* red-600 */
            border-radius: 50%;
            cursor: pointer;
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #dc2626; /* red-600 */
            border-radius: 50%;
            cursor: pointer;
            border: none; /* Remove default border in Firefox */
        }
        /* Style for the slider track */
         input[type="range"] {
            height: 8px;
            cursor: pointer;
            border-radius: 9999px; /* Full round */
            background-color: #e5e7eb; /* gray-200 */
        }
        /* Style for the info icon hover */
        .info-icon-container {
            position: relative;
            display: inline-block;
        }
        .info-tooltip {
            visibility: hidden;
            width: 160px;
            background-color: #374151; /* gray-700 */
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%; /* Position above the icon */
            left: 50%;
            margin-left: -80px; /* Center the tooltip */
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.75rem; /* text-xs */
        }
        .info-icon-container:hover .info-tooltip {
            visibility: visible;
            opacity: 1;
        }
         /* Style for the copy feedback message */
        #copyFeedback {
            transition: opacity 0.5s ease-out;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div class="bg-white rounded-lg shadow-lg p-8 w-full max-w-md">

        <div class="relative mb-4">
            <input
                type="text"
                id="passwordDisplay"
                readonly
                class="w-full p-4 pr-20 text-xl font-mono bg-gray-50 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                placeholder="Generating..."
            >
            <div class="absolute inset-y-0 right-0 flex items-center pr-3 space-x-2">
                 <button id="copyButton" title="Copy password" class="text-gray-500 hover:text-indigo-600 focus:outline-none">
                    <i class="lucide lucide-copy text-xl"></i>
                </button>
                 <button id="refreshButton" title="Generate new password" class="text-gray-500 hover:text-indigo-600 focus:outline-none">
                    <i class="lucide lucide-refresh-cw text-xl"></i>
                </button>
            </div>
            <div id="copyFeedback" class="absolute -bottom-5 right-3 text-xs text-green-600 opacity-0">
                Copied!
            </div>
        </div>

        <div id="strengthBar" class="h-1.5 rounded-full bg-gray-300 mb-6 transition-colors duration-300"></div>

        <h2 class="text-xl font-semibold mb-4 text-gray-700">Customize your password</h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <div class="mb-6">
                    <label for="passwordLength" class="block text-sm font-medium text-gray-700 mb-2">Password Length</label>
                    <div class="flex items-center space-x-3">
                        <input
                            type="range"
                            id="passwordLength"
                            min="4"
                            max="32"
                            value="12"
                            class="w-full appearance-none bg-gray-200 rounded-full h-2 cursor-pointer"
                        >
                        <span id="lengthValue" class="text-lg font-semibold text-gray-800 w-8 text-center">12</span>
                    </div>
                </div>

                <div class="space-y-3">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Password Type</label>
                    <div class="flex items-center">
                        <input id="typeEasySay" name="passwordType" type="radio" value="easySay" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                        <label for="typeEasySay" class="ml-2 block text-sm text-gray-900">Easy to say</label>
                        <div class="info-icon-container ml-1">
                            <i class="lucide lucide-info text-gray-400 text-xs cursor-help"></i>
                            <span class="info-tooltip">Avoids numbers and symbols.</span>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <input id="typeEasyRead" name="passwordType" type="radio" value="easyRead" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                        <label for="typeEasyRead" class="ml-2 block text-sm text-gray-900">Easy to read</label>
                         <div class="info-icon-container ml-1">
                            <i class="lucide lucide-info text-gray-400 text-xs cursor-help"></i>
                            <span class="info-tooltip">Avoids ambiguous characters (I, l, 1, O, 0, o).</span>
                        </div>
                    </div>
                     <div class="flex items-center">
                        <input id="typeAllChars" name="passwordType" type="radio" value="allChars" checked class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                        <label for="typeAllChars" class="ml-2 block text-sm text-gray-900">All characters</label>
                         <div class="info-icon-container ml-1">
                            <i class="lucide lucide-info text-gray-400 text-xs cursor-help"></i>
                            <span class="info-tooltip">Includes any combination of selected characters.</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="space-y-3">
                 <label class="block text-sm font-medium text-gray-700 mb-1">Character Sets</label>
                 <div class="flex items-center">
                    <input id="includeUppercase" type="checkbox" checked class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                    <label for="includeUppercase" class="ml-2 block text-sm text-gray-900">Uppercase (A-Z)</label>
                 </div>
                 <div class="flex items-center">
                    <input id="includeLowercase" type="checkbox" checked class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                    <label for="includeLowercase" class="ml-2 block text-sm text-gray-900">Lowercase (a-z)</label>
                 </div>
                 <div class="flex items-center">
                    <input id="includeNumbers" type="checkbox" checked class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                    <label for="includeNumbers" class="ml-2 block text-sm text-gray-900">Numbers (0-9)</label>
                 </div>
                 <div class="flex items-center">
                    <input id="includeSymbols" type="checkbox" checked class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                    <label for="includeSymbols" class="ml-2 block text-sm text-gray-900">Symbols (!@#...)</label>
                 </div>
            </div>
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const passwordDisplay = document.getElementById('passwordDisplay');
        const passwordLengthSlider = document.getElementById('passwordLength');
        const lengthValueDisplay = document.getElementById('lengthValue');
        const copyButton = document.getElementById('copyButton');
        const refreshButton = document.getElementById('refreshButton');
        const strengthBar = document.getElementById('strengthBar');
        const copyFeedback = document.getElementById('copyFeedback');

        // Checkboxes
        const includeUppercaseCheckbox = document.getElementById('includeUppercase');
        const includeLowercaseCheckbox = document.getElementById('includeLowercase');
        const includeNumbersCheckbox = document.getElementById('includeNumbers');
        const includeSymbolsCheckbox = document.getElementById('includeSymbols');
        const checkboxes = [includeUppercaseCheckbox, includeLowercaseCheckbox, includeNumbersCheckbox, includeSymbolsCheckbox];

        // Radio Buttons
        const typeEasySayRadio = document.getElementById('typeEasySay');
        const typeEasyReadRadio = document.getElementById('typeEasyRead');
        const typeAllCharsRadio = document.getElementById('typeAllChars');
        const passwordTypeRadios = document.querySelectorAll('input[name="passwordType"]');

        // --- Character Sets ---
        const uppercaseChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        const lowercaseChars = 'abcdefghijklmnopqrstuvwxyz';
        const numberChars = '0123456789';
        const symbolChars = '!@#$%^&*()_+-=[]{}|;:\'",.<>/?`~';
        const ambiguousChars = 'Il1O0o'; // Characters to exclude for 'Easy to read'

        // --- Event Listeners ---

        // Update length display and generate password on slider change
        passwordLengthSlider.addEventListener('input', (event) => {
            lengthValueDisplay.textContent = event.target.value;
            generatePassword();
        });

        // Generate password when checkboxes change
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', generatePassword);
        });

        // Generate password and adjust checkboxes when radio buttons change
        passwordTypeRadios.forEach(radio => {
            radio.addEventListener('change', handlePasswordTypeChange);
        });

        // Generate new password on refresh button click
        refreshButton.addEventListener('click', generatePassword);

        // Copy password to clipboard on copy button click
        copyButton.addEventListener('click', copyPassword);

        // --- Functions ---

        // Handle changes in password type selection
        function handlePasswordTypeChange() {
            const selectedType = document.querySelector('input[name="passwordType"]:checked').value;

            // Enable/disable checkboxes based on type
            if (selectedType === 'easySay') {
                includeNumbersCheckbox.checked = false;
                includeNumbersCheckbox.disabled = true;
                includeSymbolsCheckbox.checked = false;
                includeSymbolsCheckbox.disabled = true;
                 // Ensure at least one alpha character set is selected
                 if (!includeUppercaseCheckbox.checked && !includeLowercaseCheckbox.checked) {
                    includeLowercaseCheckbox.checked = true;
                 }
                 includeUppercaseCheckbox.disabled = false;
                 includeLowercaseCheckbox.disabled = false;
            } else {
                includeNumbersCheckbox.disabled = false;
                includeSymbolsCheckbox.disabled = false;
                includeUppercaseCheckbox.disabled = false;
                includeLowercaseCheckbox.disabled = false;
            }

            generatePassword();
        }

        // Generate the password based on current settings
        function generatePassword() {
            const length = parseInt(passwordLengthSlider.value);
            const includeUppercase = includeUppercaseCheckbox.checked;
            const includeLowercase = includeLowercaseCheckbox.checked;
            const includeNumbers = includeNumbersCheckbox.checked;
            const includeSymbols = includeSymbolsCheckbox.checked;
            const passwordType = document.querySelector('input[name="passwordType"]:checked').value;

            let availableChars = '';
            let guaranteedChars = ''; // Ensure at least one char from each selected set

            // Build the pool of available characters based on checkboxes
            if (includeUppercase) {
                availableChars += uppercaseChars;
                guaranteedChars += getRandomChar(uppercaseChars);
            }
            if (includeLowercase) {
                availableChars += lowercaseChars;
                 guaranteedChars += getRandomChar(lowercaseChars);
            }
            // Numbers allowed unless 'Easy to say' is checked AND includeNumbers is checked
            if (includeNumbers && !typeEasySayRadio.checked) {
                availableChars += numberChars;
                 guaranteedChars += getRandomChar(numberChars);
            }
             // Symbols allowed unless 'Easy to say' is checked AND includeSymbols is checked
            if (includeSymbols && !typeEasySayRadio.checked) {
                availableChars += symbolChars;
                 guaranteedChars += getRandomChar(symbolChars);
            }

             // Handle 'Easy to read' - filter out ambiguous characters
            if (passwordType === 'easyRead') {
                // Filter the main pool
                availableChars = availableChars.split('').filter(char => !ambiguousChars.includes(char)).join('');

                // Regenerate guaranteed chars ensuring they are not ambiguous and the set was selected
                guaranteedChars = '';
                 if (includeUppercase) {
                    let filteredUpper = uppercaseChars.split('').filter(char => !ambiguousChars.includes(char)).join('');
                    if(filteredUpper) guaranteedChars += getRandomChar(filteredUpper);
                 }
                 if (includeLowercase) {
                     let filteredLower = lowercaseChars.split('').filter(char => !ambiguousChars.includes(char)).join('');
                     if(filteredLower) guaranteedChars += getRandomChar(filteredLower);
                 }
                 if (includeNumbers && !typeEasySayRadio.checked) { // Check numbers only if allowed by type
                     let filteredNumbers = numberChars.split('').filter(char => !ambiguousChars.includes(char)).join('');
                     if(filteredNumbers) guaranteedChars += getRandomChar(filteredNumbers);
                 }
                 if (includeSymbols && !typeEasySayRadio.checked) { // Check symbols only if allowed by type
                     // Assume symbols are generally not ambiguous, but filter if needed
                     let filteredSymbols = symbolChars.split('').filter(char => !ambiguousChars.includes(char)).join('');
                     if(filteredSymbols) guaranteedChars += getRandomChar(filteredSymbols);
                 }
            }


            // Ensure at least one character set is selected *after* filtering
            if (availableChars === '') {
                passwordDisplay.value = 'Select options';
                updateStrengthIndicator(0); // No strength
                return;
            }

            let generatedPassword = '';
            // Start with guaranteed characters
            generatedPassword += guaranteedChars;

            // Fill the rest of the password length
            const remainingLength = length - generatedPassword.length;
            for (let i = 0; i < remainingLength; i++) {
                 // Ensure we don't get stuck if availableChars is empty after filtering/guaranteeing
                 if (availableChars.length === 0) break;
                 generatedPassword += getRandomChar(availableChars);
            }

            // Shuffle the final password string
            generatedPassword = shuffleString(generatedPassword);

            // Ensure password length is exactly as requested (in case guaranteed chars exceeded length initially)
            // Or if the available pool ran out early. Pad if necessary (though unlikely with shuffle).
            if (generatedPassword.length > length) {
                 generatedPassword = generatedPassword.slice(0, length);
            } else if (generatedPassword.length < length && availableChars.length > 0) {
                // Pad if too short and characters are available (edge case)
                while(generatedPassword.length < length) {
                     generatedPassword += getRandomChar(availableChars);
                }
                generatedPassword = shuffleString(generatedPassword); // Reshuffle after padding
            }


            passwordDisplay.value = generatedPassword;
            updateStrengthIndicator(calculateStrength(generatedPassword, length));
        }

        // Get a random character from a string
        function getRandomChar(charSet) {
            // Added check for empty or undefined charSet
            if (!charSet || charSet.length === 0) return '';
            const randomIndex = Math.floor(Math.random() * charSet.length);
            return charSet[randomIndex];
        }

        // Shuffle a string (Fisher-Yates algorithm)
        function shuffleString(str) {
            const arr = str.split('');
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]]; // Swap elements
            }
            return arr.join('');
        }

        // Calculate password strength score (0-100)
        function calculateStrength(password, length) {
            let score = 0;
            let typesUsed = 0;

            // Check password content only if it's not the placeholder
            if(password && password !== 'Select options') {
                if (/[a-z]/.test(password)) typesUsed++;
                if (/[A-Z]/.test(password)) typesUsed++;
                if (/[0-9]/.test(password)) typesUsed++;
                if (/[^a-zA-Z0-9]/.test(password)) typesUsed++; // Check for symbols
            } else {
                return 0; // No strength if no password or placeholder
            }


            // Base score on length
            score += Math.min(length * 4, 40); // Max 40 points for length (up to 10 chars)

            // Bonus for variety
            if (typesUsed > 1) score += typesUsed * 5; // Bonus for multiple types
            if (typesUsed >= 3 && length >= 8) score += 15;
            if (typesUsed === 4 && length >= 12) score += 20;


            // Ensure score is within 0-100
            return Math.min(Math.max(score, 0), 100);
        }

        // Update the strength indicator bar color and width
        function updateStrengthIndicator(strengthScore) {
            let colorClass = 'bg-gray-300'; // Default/No password
            if (strengthScore >= 75) {
                colorClass = 'bg-green-500'; // Strong
            } else if (strengthScore >= 40) {
                colorClass = 'bg-yellow-500'; // Medium
            } else if (strengthScore > 0) {
                 colorClass = 'bg-red-500'; // Weak
            }

            // Remove old color classes and add the new one
            strengthBar.classList.remove('bg-gray-300', 'bg-red-500', 'bg-yellow-500', 'bg-green-500');
            strengthBar.classList.add(colorClass);

            // Update width (percentage) - ensure width is 0 if score is 0
            strengthBar.style.width = `${strengthScore > 0 ? strengthScore : 0}%`;
        }

        // Copy password to clipboard
        function copyPassword() {
            if (!passwordDisplay.value || passwordDisplay.value === 'Select options') return; // Don't copy placeholder

            navigator.clipboard.writeText(passwordDisplay.value)
                .then(() => {
                    // Show feedback message
                    copyFeedback.style.opacity = '1';
                    // Hide feedback message after a short delay
                    setTimeout(() => {
                        copyFeedback.style.opacity = '0';
                    }, 1500); // 1.5 seconds
                })
                .catch(err => {
                    console.error('Failed to copy password: ', err);
                    // Optionally show an error message to the user here
                    alert("Could not copy password to clipboard."); // Simple fallback alert
                });
        }

        // --- Initial Setup ---
        // Set initial length display
        lengthValueDisplay.textContent = passwordLengthSlider.value;
        // Generate an initial password on load
        handlePasswordTypeChange(); // Call this to set initial checkbox states and generate

    </script>
</body>
</html>
